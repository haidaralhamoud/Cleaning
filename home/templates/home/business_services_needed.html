{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Available Services</title>
  <link rel="stylesheet" href="{% static 'css/base.css' %}">
  <link rel="stylesheet" href="{% static 'css/main_header.css' %}">
  <link rel="stylesheet" href="{% static 'css/business_services_needed.css' %}">
  <link rel="stylesheet" href="{% static 'css/business_steps.css' %}">
</head>

<body>
  <!-- Header -->
  {% include "home/includes/main_header.html" %}

  <br>
  <br>
  <br>
  <br>

  <div class="services-needed">
    <div class="steps">
      {% for i in range_total_steps %}
        <div class="step {% if step == i %}active{% endif %}">
          Step {{ i }}
        </div>
      {% endfor %}
    </div>

    <div class="title">
      <span class="icon" aria-hidden="true">&#129532;</span>
      <h2>Available Services</h2>
    </div>

    <div class="services-grid">
      {% for s in services %}
        <div class="service-card" data-id="{{ s.id }}" data-name="{{ s.title }}">
          <div class="checkmark"></div>
          <span class="selected-pill">Selected</span>
          <img class="service-icon" src="{{ s.icon.url }}" alt="{{ s.title }}">
          <h3>{{ s.title }}</h3>
          <p>{{ s.description_service_aviable }}</p>
        </div>
      {% endfor %}
    </div>

    <div class="form-actions buttons">
      <a onclick="window.history.back();" class="back-btn">
        <span class="back-icon">&larr;</span>
        Back
      </a>
      <form method="POST" id="servicesForm" data-skip-validate>
        {% csrf_token %}
        <input type="hidden" name="selected_services" id="selectedServicesInput">
        <button type="submit" class="next-btn">
          Continue
          <span class="next-icon">&rarr;</span>
        </button>
      </form>
    </div>
  </div>

  {% include "home/includes/footer.html" %}

  <script>
    const cards = document.querySelectorAll('.service-card');
    let selected = [];

    cards.forEach((card) => {
      card.addEventListener('click', () => {
        const serviceName = card.dataset.name;
        card.classList.toggle('selected');

        if (card.classList.contains('selected')) {
          selected.push(serviceName);
        } else {
          selected = selected.filter((s) => s !== serviceName);
        }

        document.getElementById('selectedServicesInput').value = JSON.stringify(selected);
      });
    });
  </script>

  <script src="{% static 'js/main_header.js' %}"></script>
</body>
</html>
