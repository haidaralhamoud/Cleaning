{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Hembla - All Services</title>
  <link rel="stylesheet" href="{% static 'css/base.css' %}">

  <link rel="stylesheet" href="{% static 'css/AllServicesPrivate.css' %}">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@500;700&family=Vesper+Libre:wght@400;700&display=swap" rel="stylesheet">
<style>

.header-right {
    display: flex;
    align-items: center;
    gap: 20px;
}

.cart-box {
    position: relative;
    font-size: 25px;
    color: #000;
    text-decoration: none;
}

.cart-box span {
    background: #00a3c8;
    color: #fff;
    padding: 2px 7px;
    border-radius: 50%;
    font-size: 12px;
    position: absolute;
    top: -10px;
    right: -10px;
}


</style>
</head>
<header class="main-header">
  <div class="logo">
    <img src="{% static 'images/logo.png' %}" alt="Logo">
  </div>

  <nav class="nav-links" id="nav-links">
    <a href="{% url 'home:home' %}">HOME</a>
    <a href="{% url 'home:about' %}">ABOUT</a>
    <a href="#">SERVICES</a>
    <a href="#">PRICING</a>
    <a href="#">CONTACT</a>
  </nav>

  <div class="header-right">

      <!-- ðŸ”¥ Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª -->
      <a href="/private/cart/" class="cart-box">
          ðŸ›’
          <span id="cart-count">
              {{ request.session.private_cart|length|default:0 }}
          </span>
      </a>

      <a href="#" class="profile-btn">My Profile</a>

  </div>
</header>

<body>

<main class="services-section">

    <div class="section-header">
      <h1>All Services</h1>
      <div class="filter">
        <img src="{% static 'images/filter0.png' %}" alt="Filter">
      </div>
    </div>

    <hr />

    <div class="services-list">

      {% for service in services %}
      <div class="service-card fade-in">

        <img src="{{ service.image.url }}" alt="{{ service.title }}">

        <div class="service-info">
          <h2>{{ service.title }}</h2>
          <p>{{ service.description }}</p>

          {% if service.recommended %}
            <span>Recommended: {{ service.recommended }}</span>
          {% endif %}
        </div>

        <div class="service-actions">
<button class="btn-cart" onclick="addToCart('{{ service.slug }}')">
    Add to Cart
</button>

<a href="{% url 'home:private_zip_step1' service.slug %}" class="btn-book">Book Now</a>

        </div>

      </div>
      {% endfor %}

    </div>
</main> 

<script>
function addToCart(slug) {
    fetch(`/private/cart/add/${slug}/`)
        .then(r => r.json())
        .then(data => {
            if (data.count !== undefined) {
                document.getElementById("cart-count").innerText = data.count;
            }
        });
}

</script>
<script>
function refreshCartCount() {
    fetch("/private/cart/count/")
        .then(r => r.json())
        .then(data => {
            if (data.count !== undefined) {
                document.getElementById("cart-count").innerText = data.count;
            }
        })
        .catch(err => console.log("Cart Refresh Error:", err));
}

// ðŸ”„ ÙŠØ­Ø¯Ø« Ø§Ù„Ø¹Ø¯Ø¯ ÙƒÙ„ 2 Ø«Ø§Ù†ÙŠØ©
setInterval(refreshCartCount, 2000);
</script>

</body>
</html>
