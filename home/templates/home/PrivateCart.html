{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Your Cart ' Hembla experten</title>
<link rel="stylesheet" href="{% static 'css/base.css' %}">
<link rel="stylesheet" href="{% static 'css/main_header.css' %}">
<link rel="stylesheet" href="{% static 'css/PrivateCart.css' %}">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
<link href="https://fonts.googleapis.com/css2family=Fraunces:opsz,wght@9..144,600;9..144,700&family=Manrope:wght@400;500;600;700&display=swap" rel="stylesheet">

</head>
<body>
{% include "home/includes/main_header.html" %}

<!-- ًں”¥ ط¹ظ†طµط± ظ…ط®ظپظٹ ظ„ط­طھظ‰ JS ظٹظ„ط§ظ‚ظٹ cart-count -->
<div style="display:none;">
    <span id="cart-count">{{ cart|length }}</span>
</div>

<div class="container cart-shell">

    <h1 class="mb-4">Your Cart</h1>

    {% if services %}
        {% for s in services %}
        <div class="cart-item" id="item-{{ s.slug }}">

            {% if s.image %}
                <img src="{{ s.image.url }}" alt="{{ s.title }}">
            {% else %}
                <div class="cart-image placeholder" aria-hidden="true">{{ s.title|first }}</div>
            {% endif %}

            <div class="cart-info">
                <h3>{{ s.title }}</h3>
                <p>{{ s.description|truncatewords:15 }}</p>
            </div>

            <button onclick="removeItem('{{ s.slug }}')" class="remove-btn">
                Remove
            </button>

        </div>
        {% endfor %}

        <a href="{% url 'home:private_cart_continue' %}" class="btn-continue">
            Continue Booking '
        </a>

    {% else %}
        <div class="cart-empty">
            <h4>Your cart is empty.</h4>
            <p>Pick a service to start building your clean plan.</p>
            <a href="{% url 'home:all_services_private' %}" class="btn-continue">
                Browse Services
            </a>
        </div>
    {% endif %}

</div>

<script>
function removeItem(slug) {
    fetch(`/private/cart/remove-json/${slug}/`)
        .then(r => r.json())
        .then(data => {

            // ط§ط­ط°ظپ ط§ظ„ط¹ظ†طµط± ظ…ظ† ط§ظ„طµظپط­ط©
            const item = document.getElementById(`item-${slug}`);
            if (item) item.remove();

            // ط­ط¯ظ'ط« ط¹ط¯ط§ط¯ ط§ظ„ط³ظ„ط© (ظ…ظˆط¬ظˆط¯ ط§ظ„ط¢ظ† ظ„ط£ظ†ظƒ ظ†ظ‚ظ„طھ ط§ظ„ظ‡ظٹط¯ط±)
            const counter = document.getElementById("cart-count");
            if (counter) counter.innerText = data.count;

        })
        .catch(err => console.error("Remove error:", err));
}


</script>
<script src="{% static 'js/main_header.js' %}"></script>
{% include "home/includes/footer.html" %}
</body>

</html>



