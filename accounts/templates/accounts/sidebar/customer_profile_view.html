{% load static %}
{% load bootstrap4 %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Customer Profile Overview</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Vesper+Libre:wght@400;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="{% static 'css/base.css' %}">
<link rel="stylesheet" href="{% static 'css/customer_profile_view.css' %}">

<style>
  .edit-only .form-control {
  width: 100%;
  padding: 8px 10px;
  border-radius: 6px;
  border: 1px solid #d1d5db;
  font-size: 14px;
}

.edit-only select.form-control {
  height: 38px;
}

.field {
  margin-bottom: 12px;
}
/* ================= BASIC ================= */
.layout {
  display: flex;
  min-height: 100vh;
}

.sidebar {
  width: 300px;
  background: #fff;
}

/* ================= MOBILE ================= */
@media (max-width: 991px) {

  .main-header {
    position: sticky;
    top: 0;
    z-index: 1100;
  }

  .profile-btn {
    display: none;
  }

  .layout {
    flex-direction: column;
  }

  /* ===== SIDEBAR ===== */
  .sidebar {
    position: fixed;
    top: 0px;
    margin-top: 71px;
    left: -50px;
    width: 300px;
    height: 90vh;
    background: #fff;
    z-index: 1000;

    overflow-y: auto;
    -webkit-overflow-scrolling: touch;

    transform: translateX(-100%);
    transition: transform 0.3s ease;
  }

  .sidebar.open {
    transform: translateX(0);
  }

  /* ===== OVERLAY ===== */
  .sidebar-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.35);
    z-index: 999;
    display: none;
  }

  .sidebar.open ~ .sidebar-overlay {
    display: block;
  }

  /* ===== CONTENT ===== */
  .content {
    padding: 16px;
  }

  .cards-container {
    display: flex;
    flex-direction: column;
    gap: 16px;
  }

  .left-column,
  .right-column {
    width: 100%;
  }

  /* ===== NAV LINKS (Ø§Ø®ØªÙŠØ§Ø±ÙŠ â€“ dropdown) ===== */
  .nav-links {
    position: fixed;
    top: 70px;
    left: 0;
    right: 0;
    background: #fff;
    display: none;
    flex-direction: column;
    align-items: center;
    gap: 18px;
    padding: 20px 0;
    z-index: 1050;
    box-shadow: 0 10px 20px rgba(0,0,0,0.15);
  }

  .nav-links.active {
    display: flex;
  }
}

/* ===== SCROLLBAR ===== */
.sidebar::-webkit-scrollbar {
  width: 5px;
}
.sidebar::-webkit-scrollbar-thumb {
  background: #ccebf3;
  border-radius: 10px;
}
@media (max-width: 991px) {
  body {
    padding-top: 0 !important;
  }

  .content {
    margin-top: 0 !important;
  }
}

</style>
</head>

<body>

<!-- ================= HEADER ================= -->
<header class="main-header">


  
  <!-- Ø²Ø± Ø§Ù„Ø³Ø§ÙŠØ¯Ø¨Ø§Ø± -->
  <button class="menu-toggle profile-toggle" id="sidebarToggle">ðŸ‘¤</button>

  <div class="logo">
    <img src="{% static 'images/logo.png' %}">
  </div>
  <!-- Ø²Ø± Ø§Ù„Ù†Ø§ÙØ¨Ø§Ø± -->
  <button class="menu-toggle" id="navToggle">â˜°</button>
  <nav class="nav-links" id="nav-links">
    <a href="{% url 'home:home' %}">HOME</a>
    <a href="{% url 'home:about' %}">ABOUT</a>
    <a href="#">SERVICES</a>
    <a href="#">PRICING</a>
    <a href="#">CONTACT</a>
  </nav>

  <div class="profile-btn">
    <a href="#">My Profile</a>
  </div>
</header>

<!-- ================= LAYOUT ================= -->
<div class="layout">

<!-- ================= SIDEBAR ================= -->
<aside class="sidebar" id="sidebar">

    <div class="profile-head">
      <div class="avatar"></div>
      <div>
    <div class="name">{{ customer.first_name }} {{ customer.last_name }}</div>
    <div class="id">ID: {{ customer.id }}</div>
      </div>
    </div>

     <form id="logout-form" method="post" action="{% url 'logout' %}" style="display:none;">
      {% csrf_token %}
    </form>

    <nav class="side-nav">
      <a href="{% url 'accounts:customer_profile_view' %}" class="nav-item active"><img src="{% static 'images/user-location0.png' %}" class="ico"><span>Overview</span></a>
      <a href="{% url 'accounts:Address_and_Locations_view' %}" class="nav-item"><img src="{% static 'images/user-location1.png' %}" class="ico"><span>Address & Locations</span></a>
      <a href="{% url 'accounts:my_bookimg' %}" class="nav-item"><img src="{% static 'images/event-accepted0.png'%}" class="ico"><span>My Bookings</span></a>
      <a href="{% url 'accounts:incident' %}" class="nav-item"><img src="{% static 'images/user-location1.png'%}" class="ico"><span>Incidents</span></a>
      <a href="{% url 'accounts:Service_Preferences' %}" class="nav-item"><img src="{% static 'images/settings0.png'%}" class="ico"><span>Service Preferences</span></a>
      <a href="{% url 'accounts:Communication' %}" class="nav-item"><img src="{% static 'images/communication0.png'%}" class="ico"><span>Communication</span></a>
      <a href="{% url 'accounts:Customer_Notes' %}" class="nav-item"><img src="{% static 'images/list-view0.png'%}" class="ico"><span>Customer Notes</span></a>
      <a href="{% url 'accounts:Payment_and_Billing' %}" class="nav-item"><img src="{% static 'images/magnetic-card0.png'%}" class="ico"><span>Payment & Billing</span></a>
      <a href="{% url 'accounts:Change_Password' %}" class="nav-item"><img src="{% static 'images/person1.png'%}" class="ico"><span>Change Password</span></a>
      <a href="{% url 'accounts:Service_History_and_Ratings' %}" class="nav-item"><img src="{% static 'images/vector2.svg'%}" class="ico"><span>Service History & Ratings</span></a>
      <a href="{% url 'accounts:Loyalty_and_Rewards' %}" class="nav-item"><img src="{% static 'images/prize0.png'%}" class="ico"><span>Loyalty & Rewards</span></a>
      <a href="#" class="nav-item" onclick="event.preventDefault(); document.getElementById('logout-form').submit();"><img src="{% static 'images/logout-rounded0.png' %}" class="ico"><span>Logout</span></a>
    </nav>
</aside>

<div class="sidebar-overlay" id="sidebarOverlay"></div>

<!-- ================= CONTENT ================= -->
    <!-- Main -->
    <main class="content">
      <h1 class="page-title">Customer Profile Overview</h1>

      <div class="cards-container">
        <div class="left-column">

          <article class="card ongoing-orders">
  <div class="card-header">
    <div class="card-title with-icon">
      <img src="{% static 'images/logistics0.png'%}" class="tiny-ico" alt="">
      <span>Ongoing Orders</span>
    </div>
     <a href="{% url 'accounts:my_bookimg' %}"><button class="btn btn-sky-subtle big">View All Orders</button></a>
  </div>
  <p class="muted subtitle">Active and scheduled services.</p>

  <div class="order-block">
    <div class="order-line">
      <div class="order-info">
        <div class="order-name">Weekly House Cleaning</div>
        <div class="order-id">Order ID: #SO-987654</div>
        <div class="order-date">
          <img src="{% static 'images/calendar1.png'%}" alt="">
          <span>Next Service: Oct 23, 2024</span>
        </div>
      </div>
      <div class="order-actions">
        <span class="pill pill-info">In Progress</span>
        <button class="btn btn-outline">View Details</button>
      </div>
    </div>

    <div class="order-line">
      <div class="order-info">
        <div class="order-name">Deep Carpet Cleaning</div>
        <div class="order-id">Order ID: #SO-987655</div>
        <div class="order-date">
          <img src="{% static 'images/calendar1.png'%}" alt="">
          <span>Scheduled: Oct 28, 2024</span>
        </div>
      </div>
      <div class="order-actions">
        <span class="pill pill-warn">Scheduled</span>
        <button class="btn btn-outline">View Details</button>
      </div>
    </div>
  </div>
</article>

<form method="post" enctype="multipart/form-data">
{% csrf_token %}

<article class="card basic-info">

  <div class="card-header">
    <div class="card-title with-icon">
      <img src="{% static 'images/person0.png'%}" class="tiny-ico">
      <span>Basic Information</span>
    </div>
    <button class="icon-ghost" type="button" onclick="toggleBasicEdit()">
      <img src="{% static 'images/edit-pencil1.png'%}" alt="">
    </button>
  </div>

  <div class="info-grid3">

    <!-- ================= Column 1 ================= -->
    <div class="col">
      <img src="{% static 'images/ellipse-270.png'%}" alt="profile" class="profile-icon">

      <div class="field">
        <div class="label">Email Address</div>
        <div class="val view-only">{{ customer.email }}</div>
        <div class="edit-only" style="display:none">
          {{ basic_form.email }}
        </div>
      </div>

      <div class="field">
        <div class="label">Preferred language</div>
        <div class="val view-only">{{ customer.get_preferred_language_display }}</div>
        <div class="edit-only" style="display:none">
          {{ basic_form.preferred_language }}
        </div>
      </div>

      <div class="field">
        <div class="label">Date of birth</div>
        <div class="val view-only">
          {% if customer.date_of_birth %}
            {{ customer.date_of_birth|date:"d/m/Y" }}
          {% else %} â€” {% endif %}
        </div>
        <div class="edit-only" style="display:none">
          {{ basic_form.date_of_birth }}
        </div>
      </div>
    </div>

    <!-- ================= Column 2 ================= -->
    <div class="col">
      <div class="field">
        <div class="label">First Name</div>
        <div class="val view-only">{{ customer.first_name }}</div>
        <div class="edit-only" style="display:none">
          {{ basic_form.first_name }}
        </div>
      </div>

      <div class="field">
        <div class="label">Country code</div>
        <div class="val view-only">{{ customer.country_code|default:"â€”" }}</div>
        <div class="edit-only" style="display:none">
          {{ basic_form.country_code }}
        </div>
      </div>

      <div class="field">
        <div class="label">Preferred contact method</div>
        <div class="val view-only">
          {{ customer.get_preferred_contact_method_display|default:"â€”" }}
        </div>
        <div class="edit-only" style="display:none">
          {{ basic_form.preferred_contact_method }}
        </div>
      </div>

      <div class="field">
        <div class="label">Gender</div>
        <div class="val view-only">{{ customer.gender|default:"â€”"|capfirst }}</div>
        <div class="edit-only" style="display:none">
          {{ basic_form.gender }}
        </div>
      </div>
    </div>

    <!-- ================= Column 3 ================= -->
    <div class="col">
      <div class="field">
        <div class="label">Last Name</div>
        <div class="val view-only">{{ customer.last_name }}</div>
        <div class="edit-only" style="display:none">
          {{ basic_form.last_name }}
        </div>
      </div>

      <div class="field">
        <div class="label">Phone number</div>
        <div class="val view-only">{{ customer.phone }}</div>
        <div class="edit-only" style="display:none">
          {{ basic_form.phone }}
        </div>
      </div>

      <div class="field">
        <div class="label">Pronouns</div>
        <div class="val view-only">{{ customer.pronouns|default:"â€”" }}</div>
        <div class="edit-only" style="display:none">
          {{ basic_form.pronouns }}
        </div>
      </div>
    </div>

  </div>


  <!-- ================= Emergency Contact (Ù…Ø§ Ø¨ÙŠÙ†Ù…Ø³) ================= -->
<div class="emergency">
  <div class="em-title">Emergency contact</div>

  <div class="grid">

    <div class="field">
      <div class="label">First Name</div>
      <div class="val view-only">
        {{ customer.emergency_first_name|default:"â€”" }}
      </div>
      <div class="edit-only" style="display:none">
        <input type="text"
               name="emergency_first_name"
               class="form-control"
               value="{{ customer.emergency_first_name }}">
      </div>
    </div>

    <div class="field">
      <div class="label">Last Name</div>
      <div class="val view-only">
        {{ customer.emergency_last_name|default:"â€”" }}
      </div>
      <div class="edit-only" style="display:none">
        <input type="text"
               name="emergency_last_name"
               class="form-control"
               value="{{ customer.emergency_last_name }}">
      </div>
    </div>

    <div class="field">
      <div class="label">Phone number</div>
      <div class="val view-only">
        {{ customer.emergency_phone|default:"â€”" }}
      </div>
      <div class="edit-only" style="display:none">
        <input type="text"
               name="emergency_phone"
               class="form-control"
               value="{{ customer.emergency_phone }}">
      </div>
    </div>

    <div class="field">
      <div class="label">Relation</div>
      <div class="val view-only">
        {{ customer.emergency_relation|default:"â€”" }}
      </div>
      <div class="edit-only" style="display:none">
        <input type="text"
               name="emergency_relation"
               class="form-control"
               value="{{ customer.emergency_relation }}">
      </div>
    </div>
  <!-- ================= ACTIONS ================= -->
  <div class="edit-actions" style="display:none; text-align:right; margin-top:15px">
    <button type="submit" class="btn btn-primary">Save</button>
    <button type="button" class="btn btn-outline" onclick="toggleBasicEdit()">Cancel</button>
  </div>
  </div>
</div>

</article>
</form>



<article class="card">
  <div class="card-header">
    <div class="card-title with-icon">
      <img src="{% static 'images/home-address0.png'%}" class="tiny-ico">
      <span>Address & Locations</span>
    </div>
    <a href="{% url 'accounts:Address_and_Locations_view' %}" class="icon-ghost">
      <img src="{% static 'images/edit-pencil2.png' %}">
    </a>
  </div>

  <div class="stack">

    <!-- Primary Address -->
    <div class="row-ic">
      <img src="{% static 'images/star0.png' %}">
      <div>
        <div class="row-title">Primary Address</div>
        <div class="row-text">
          {% if primary_location %}
            {{ primary_location.street_address }},
            {{ primary_location.city }},
            {{ primary_location.region }},
            {{ primary_location.postal_code }},
            {{ primary_location.country }}
          {% else %}
            â€”
          {% endif %}
        </div>
      </div>
    </div>

    <!-- Additional Locations -->
    <div class="row-ic">
      <img src="{% static 'images/locations1.png' %}">
      <div>
        <div class="row-title">Additional Locations</div>
        <div class="row-text">
          {% if other_locations %}
            {{ other_locations|length }} locations saved
          {% else %}
            â€”
          {% endif %}
        </div>
      </div>
    </div>

    <!-- Entry code / Access -->
    <div class="row-ic">
      <img src="{% static 'images/access0.png'%}">
      <div>
        <div class="row-title">Entry code / Access</div>
        <div class="row-text">
          {% if primary_location and primary_location.entry_code %}
            {{ primary_location.entry_code }}
          {% else %}
            â€”
          {% endif %}
        </div>
      </div>
    </div>

    <!-- Parking notes -->
    <div class="row-ic">
      <img src="{% static 'images/notes0.png'%}">
      <div>
        <div class="row-title">Parking notes</div>
        <div class="row-text">
          {% if primary_location and primary_location.parking_notes %}
            {{ primary_location.parking_notes }}
          {% else %}
            â€”
          {% endif %}
        </div>
      </div>
    </div>

  </div>
</article>

        </div>

        <div class="right-column">
          <article class="card side">
            <div class="side-head"><img src="{% static 'images/heart0.png'%}" class="side-ico"><button class="edit-btn"><img src="{% static 'images/edit-pencil0.png'%}"></button></div>
            <h3 class="side-title">Service<br>Preferences</h3>
            <p class="side-text">Set your preferences for cleaning services.</p>
            <a href="{% url 'accounts:Service_Preferences' %}"><button class="btn btn-primary full">View preferences</button></a>
          </article>

          <article class="card side">
            <div class="side-head"><img src="{% static 'images/subscription0.png'%}" class="side-ico"><button class="edit-btn"><img src="{% static 'images/edit-pencil3.png'%}"></button></div>
            <h3 class="side-title">Subscription</h3>
            <p class="side-text">you are on the Bi-Weekly Bliss plan</p>
            <button class="btn btn-primary full">Manage Subscription</button>
          </article>

          <article class="card side">
            <div class="side-head"><img src="{% static 'images/receive-cash0.png'%}" class="side-ico"><button class="edit-btn"><img src="{% static 'images/edit-pencil4.png'%}"></button></div>
            <h3 class="side-title">Payment & Billing</h3>
            <p class="side-text">Next billing date : Oct 25, 2024</p>
             <a href="{% url 'accounts:Payment_and_Billing' %}"><button class="btn btn-primary full">View billing Details</button></a>
          </article>
        </div>
      </div>
    </main>
  </div>

<footer class="footer">
  <div class="footer-container">
    <!-- Ø§Ù„Ø¹Ù…ÙˆØ¯ 1: Ø§Ù„Ù„ÙˆØ¬Ùˆ ÙˆØ§Ù„Ù†Øµ -->
    <div class="footer-col about">
      <img src="{% static 'images/logo.png' %}" alt="Hembla Logo" class="footer-logo">
      <p>
        At Hembla, we believe home should be your haven, not your to-do list. 
        From cleaning to care, weâ€™re here to make life easier, one home at a time.
      </p>

      <!-- Ø§Ù„ØµÙ Ø§Ù„Ø¥Ø¶Ø§ÙÙŠ ØªØ­Øª Ø§Ù„Ù†Øµ -->
      <div class="bottom-left">
        <!-- Connect -->
        <div class="connect">
          <h4>Connect</h4>
          <div class="socials">
            <img src="{% static 'images/facebook0.png'%}" alt="facebook">
            <img src="{% static 'images/instagram-circle0.png'%}" alt="instagram">
            <img src="{% static 'images/linked-in-circled0.png'%}" alt="linkedin">
            <img src="{% static 'images/whats-app0.png'%}" alt="whatsapp">
          </div>
        </div>


      </div>
    </div>

    <!-- Ø§Ù„Ø¹Ù…ÙˆØ¯ 2: Support -->
    <div class="footer-col support">
      <h4>Support</h4>
      <ul>
        <li><a href="#">Contact Us</a></li>
        <li><a href="#">Address</a></li>
        <li><a href="#">Working Hours</a></li>
        <li><a href="#">FAQ</a></li>
      </ul>
              <!-- App Download -->
        <div class="app-download">
          <h4>App Download</h4>
          <div class="apps">
            <img src="{% static 'images/mobile0.png'%}" alt="mobile">
            <img src="{% static 'images/chat-gpt-image-sep-15-2025-05-50-28-pm-10.png'%}" alt="app store">
          </div>
        </div>
    </div>

    <!-- Ø§Ù„Ø¹Ù…ÙˆØ¯ 3: Company -->
    <div class="footer-col company">
      <h4>Company</h4>
      <ul>
        <li><a href="#">About Us</a></li>
        <li><a href="#">Careers</a></li>
        <li><a href="#">Our Story</a></li>
        <li><a href="#">Feedback</a></li>
      </ul>
    </div>

    <!-- Ø§Ù„Ø¹Ù…ÙˆØ¯ 4: Legal / Privacy -->
    <div class="footer-col legal">
      <h4>Legal/Privacy</h4>
      <ul>
        <li><a href="#">Privacy Policy</a></li>
        <li><a href="#">Terms & Conditions</a></li>
        <li><a href="#">Cookie Policy</a></li>
        <li><a href="#">Accessibility Statement</a></li>
      </ul>
    </div>
  </div>

  <!-- Ø§Ù„Ø®Ø· Ø§Ù„ÙØ§ØµÙ„ -->
  <hr class="footer-line">

  <!-- Ø§Ù„ØµÙ Ø§Ù„Ø³ÙÙ„ÙŠ -->
  <div class="footer-bottom">
    <div class="language-box">
      <img src="{% static 'images/earth-globe0.png'%}" alt="earth" class="earth-icon">
      <span>Language</span>
    </div>
    <p>Â© 2025 Hembla Cleaning Services. All rights reserved.</p>
  </div>
</footer>

<!-- ================= JS ================= -->
<script>
/* ===== NAVBAR ===== */
const navToggle = document.getElementById("navToggle");
const navLinks = document.getElementById("nav-links");

/* ===== SIDEBAR ===== */
const sidebarToggle = document.getElementById("sidebarToggle");
const sidebar = document.getElementById("sidebar");
const sidebarOverlay = document.getElementById("sidebarOverlay");

/* ÙØªØ­ / Ø¥ØºÙ„Ø§Ù‚ Navbar */
navToggle.addEventListener("click", () => {
  navLinks.classList.toggle("active");

  // Ø³ÙƒÙ‘Ø± Ø§Ù„Ø³Ø§ÙŠØ¯Ø¨Ø§Ø± Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙØªÙˆØ­
  sidebar.classList.remove("open");
});

/* ÙØªØ­ / Ø¥ØºÙ„Ø§Ù‚ Sidebar */
sidebarToggle.addEventListener("click", () => {
  sidebar.classList.toggle("open");

  // Ø³ÙƒÙ‘Ø± Ø§Ù„Ù†Ø§ÙØ¨Ø§Ø± Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙØªÙˆØ­
  navLinks.classList.remove("active");
});

/* Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø³Ø§ÙŠØ¯Ø¨Ø§Ø± Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø®Ø§Ø±Ø¬Ù‡Ø§ */
sidebarOverlay.addEventListener("click", () => {
  sidebar.classList.remove("open");
});
</script>


<script>
function toggleBasicEdit() {
  const viewFields = document.querySelectorAll('.view-only');
  const editFields = document.querySelectorAll('.edit-only');
  const actions = document.querySelector('.edit-actions');

  const editing = editFields[0].style.display === 'block';

  viewFields.forEach(el => el.style.display = editing ? 'block' : 'none');
  editFields.forEach(el => el.style.display = editing ? 'none' : 'block');
  if (actions) actions.style.display = editing ? 'none' : 'block';
}
</script>

</body>
</html>
