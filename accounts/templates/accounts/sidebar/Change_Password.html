{% load static %}
{% load bootstrap4 %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Change Password - Customer Profile</title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Vesper+Libre:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="{% static 'css/Change_Password.css' %}">
  <link rel="stylesheet" href="{% static 'css/base.css' %}">
  <style>
    .popup-overlay{
  position: fixed;
  inset: 0;
  background: rgba(192,231,241,.85);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9999;
}

    /* ===== POPUP CONTAINER ===== */
    .frame-1686552582 {
      background: #ffffff;
      border-radius: 20px;
      width: 90%;
      max-width: 650px;
      min-height: 420px;
      position: relative;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.25);
      overflow: hidden;
      text-align: center;
      padding: 40px 30px;
      animation: popup-appear 0.6s ease-out forwards;
    }

    @keyframes popup-appear {
      0% {
        transform: translateY(60px) scale(0.85);
        opacity: 0;
      }
      100% {
        transform: translateY(0) scale(1);
        opacity: 1;
      }
    }

    /* ===== TEXT ===== */
    .your-password-has-been-updated-successfully {
      color: #000000;
      font-size: 28px;
      line-height: 40px;
      font-weight: 700;
      margin-top: 240px;
      text-align: center;
      animation: text-fade 1s ease-out forwards;
    }

    @keyframes text-fade {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* ===== CHECK MARK ===== */
    .check-mark {
      width: 120px;
      height: 120px;
      position: absolute;
      left: 50%;
      top: 100px;
      transform: translateX(-50%);
      object-fit: contain;
      animation: check-spin 1s ease-out forwards;
    }

    @keyframes check-spin {
      0% { transform: translateX(-50%) rotate(-200deg) scale(0.5); opacity: 0; }
      60% { transform: translateX(-50%) rotate(10deg) scale(1.2); opacity: 1; }
      100% { transform: translateX(-50%) rotate(0deg) scale(1); }
    }

    /* ===== CLOSE BUTTON (أزرق قبل وبعد hover) ===== */
    .close-window {
      width: 45px;
      height: 45px;
      position: absolute;
      right: 20px;
      top: 20px;
      cursor: pointer;
      transition: 0.3s;
      object-fit: contain;
      filter: brightness(0) saturate(100%) invert(41%) sepia(98%) saturate(1687%) hue-rotate(170deg) brightness(93%) contrast(92%);
      /* هذا الفلتر يعطي لون أزرق واضح */
    }

    .close-window:hover {
      transform: scale(1.1) rotate(10deg);
      filter: brightness(0) saturate(100%) invert(41%) sepia(98%) saturate(1687%) hue-rotate(170deg) brightness(120%) contrast(100%);
      /* نفس الأزرق لكن أفتح شوي فقط */
    }

    /* ===== RESPONSIVE ===== */
    @media (max-width: 600px) {
      .frame-1686552582 {
        width: 92%;
        padding: 30px 20px;
      }
      .check-mark {
        width: 100px;
        height: 100px;
        top: 80px;
      }
      .your-password-has-been-updated-successfully {
        font-size: 22px;
        margin-top: 200px;
        padding: 0 10px;
      }
      .close-window {
        width: 40px;
        height: 40px;
      }
    }
    /* errors */
.errorlist{
  margin: 8px 0 0;
  padding: 0;
  list-style: none;
}

.errorlist li,
.field-error{
  color: #e21010;
  font-weight: 600;
  font-size: 14px;
  margin-top: 6px;
}

.form-error-box{
  background: rgba(226,16,16,.08);
  border: 1px solid rgba(226,16,16,.35);
  color: #e21010;
  padding: 12px 14px;
  border-radius: 12px;
  margin-bottom: 14px;
  font-weight: 600;
}

.input-error{
  border: 1.5px solid #e21010 !important;
  box-shadow: 0 0 0 3px rgba(226,16,16,.12);
}

  </style>
</head>

<body>

<!-- HEADER -->
<header class="main-header">
  <div class="logo">
    <img src="{% static 'images/logo.png' %}" alt="Logo">
  </div>

  <div class="menu-toggle" id="menu-toggle">☰</div>

  <nav class="nav-links" id="nav-links">
    <a href="{% url 'home:home' %}">HOME</a>
    <a href="{% url 'home:about' %}">ABOUT</a>
    <a href="#">SERVICES</a>
    <a href="#">PRICING</a>
    <a href="#">CONTACT</a>
  </nav>

  <div class="profile-btn">
    <a href="#">My Profile</a>
  </div>
</header>
  <!-- ===== Mobile Header ===== -->
  <div class="mobile-header">
    <button class="menu-toggle floating" id="menuToggle">
      <span class="arrow">&#8250;</span>
    </button>
    <h2 class="mobile-title">Customer Profile</h2>
  </div>

<div class="layout">


    <!-- ===== Sidebar ===== -->
    <aside class="sidebar">
      <div class="profile-head">
        <div class="avatar"></div>
        <div>
          <div class="name">Sophia Bennett</div>
          <div class="id">ID: 123456</div>
        </div>
      </div>

      <form id="logout-form" method="post" action="{% url 'logout' %}" style="display: none;">
          {% csrf_token %}
      </form>

      <nav class="side-nav">
        <a href="{% url 'accounts:customer_profile_view' %}" class="nav-item active"><img src="{% static 'images/user-location0.png' %}" class="ico"><span>Overview</span></a>
        <a href="{% url 'accounts:Address_and_Locations_view' %}" class="nav-item"><img src="{% static 'images/user-location1.png' %}" class="ico"><span>Address & Locations</span></a>
        <a href="{% url 'accounts:my_bookimg' %}" class="nav-item"><img src="{% static 'images/event-accepted0.png'%}" class="ico"><span>My Bookings</span></a>
        <a href="{% url 'accounts:incident' %}" class="nav-item"><img src="{% static 'images/user-location1.png'%}" class="ico"><span>Incidents</span></a>
        <a href="{% url 'accounts:Service_Preferences' %}" class="nav-item"><img src="{% static 'images/settings0.png'%}" class="ico"><span>Service Preferences</span></a>
        <a href="{% url 'accounts:Communication' %}" class="nav-item" ><img src="{% static 'images/communication0.png'%}" class="ico"><span>Communication</span></a>
        <a href="{% url 'accounts:Customer_Notes' %}" class="nav-item" ><img src="{% static 'images/list-view0.png'%}" class="ico"><span>Customer Notes</span></a>
        <a href="{% url 'accounts:Payment_and_Billing' %}" class="nav-item"><img src="{% static 'images/magnetic-card0.png'%}" class="ico"><span>Payment & Billing</span></a>
        <a href="{% url 'accounts:Change_Password' %}" class="nav-item"><img src="{% static 'images/person1.png'%}" class="ico"><span>Change Password</span></a>
        <a href="{% url 'accounts:Service_History_and_Ratings' %}" class="nav-item"><img src="{% static 'images/vector2.svg'%}" class="ico"><span>Service History & Ratings</span></a>
        <a href="{% url 'accounts:Loyalty_and_Rewards' %}" class="nav-item"><img src="{% static 'images/prize0.png'%}" class="ico"><span>Loyalty & Rewards</span></a>
        <a href="#" class="nav-item" onclick="event.preventDefault(); document.getElementById('logout-form').submit();"><img src="{% static 'images/logout-rounded0.png' %}" class="ico"><span>Logout</span></a>
      </nav>
    </aside>  <!-- نفس السايدبار تبعك بدون تعديل -->


<main class="main">
  <h1>Change Password</h1>
  <h3 class="subtitle">Last Password Update March 5, 2024</h3>

  <div class="card">

    <form method="post">
      {% csrf_token %}
      {% if form.non_field_errors %}
        <div class="form-error-box">
          {% for err in form.non_field_errors %}
            <div>{{ err }}</div>
          {% endfor %}
        </div>
      {% endif %}
      <!-- Current Password -->
<label class="field-label">Current Password</label>
<div class="input-group">
  <input
    type="password"
    name="{{ form.old_password.name }}"
    placeholder="Enter current password"
    class="{% if form.old_password.errors %}input-error{% endif %}"
    required
  >
  <i class="fa-regular fa-eye icon"></i>
</div>

{% if form.old_password.errors %}
  <div class="field-error">{{ form.old_password.errors.0 }}</div>
{% endif %}


      <!-- New Password -->
<label class="field-label">New Password</label>
<div class="input-group">
  <input
    id="newPassword"
    type="password"
    name="{{ form.new_password1.name }}"
    placeholder="Enter new password"
    class="{% if form.new_password1.errors %}input-error{% endif %}"
    required
  >
  <i class="fa-regular fa-eye icon"></i>
</div>

{% if form.new_password1.errors %}
  <div class="field-error">{{ form.new_password1.errors.0 }}</div>
{% endif %}


      <!-- Strength Bar -->
      <div class="strength">
        <div class="labels">
          <span>Weak</span>
          <span>Medium</span>
          <span>Strong</span>
        </div>
        <div class="bar">
          <div id="strengthBar"></div>
        </div>
      </div>

      <p class="note">
        Must be at least 8 characters, include uppercase, lowercase, number, and special character.
      </p>

      <!-- Confirm Password -->
<label class="field-label">Confirm New Password</label>
<div class="input-group">
  <input
    type="password"
    name="{{ form.new_password2.name }}"
    placeholder="Re-enter new password"
    class="{% if form.new_password2.errors %}input-error{% endif %}"
    required
  >
  <i class="fa-regular fa-eye icon"></i>
</div>

{% if form.new_password2.errors %}
  <div class="field-error">{{ form.new_password2.errors.0 }}</div>
{% endif %}


      <p class="info">
        <i class="fa-solid fa-circle-info"></i>
        You’ll be logged out from all devices once you change your password.
      </p>

      <div class="actions">
        <button type="submit" class="btn save">Save Changes</button>
        <a href="{% url 'accounts:customer_profile_view' %}" class="btn cancel">Cancel</a>
      </div>

    </form>
  </div>
</main>

</div>
<footer class="footer">
  <div class="footer-container">
    <!-- العمود 1: اللوجو والنص -->
    <div class="footer-col about">
      <img src="{% static 'images/logo.png' %}" alt="Hembla Logo" class="footer-logo">
      <p>
        At Hembla, we believe home should be your haven, not your to-do list. 
        From cleaning to care, we’re here to make life easier, one home at a time.
      </p>

      <!-- الصف الإضافي تحت النص -->
      <div class="bottom-left">
        <!-- Connect -->
        <div class="connect">
          <h4>Connect</h4>
          <div class="socials">
            <img src="{% static 'images/facebook0.png'%}" alt="facebook">
            <img src="{% static 'images/instagram-circle0.png'%}" alt="instagram">
            <img src="{% static 'images/linked-in-circled0.png'%}" alt="linkedin">
            <img src="{% static 'images/whats-app0.png'%}" alt="whatsapp">
          </div>
        </div>


      </div>
    </div>

    <!-- العمود 2: Support -->
    <div class="footer-col support">
      <h4>Support</h4>
      <ul>
        <li><a href="#">Contact Us</a></li>
        <li><a href="#">Address</a></li>
        <li><a href="#">Working Hours</a></li>
        <li><a href="#">FAQ</a></li>
      </ul>
              <!-- App Download -->
        <div class="app-download">
          <h4>App Download</h4>
          <div class="apps">
            <img src="{% static 'images/mobile0.png'%}" alt="mobile">
            <img src="{% static 'images/chat-gpt-image-sep-15-2025-05-50-28-pm-10.png'%}" alt="app store">
          </div>
        </div>
    </div>

    <!-- العمود 3: Company -->
    <div class="footer-col company">
      <h4>Company</h4>
      <ul>
        <li><a href="#">About Us</a></li>
        <li><a href="#">Careers</a></li>
        <li><a href="#">Our Story</a></li>
        <li><a href="#">Feedback</a></li>
      </ul>
    </div>

    <!-- العمود 4: Legal / Privacy -->
    <div class="footer-col legal">
      <h4>Legal/Privacy</h4>
      <ul>
        <li><a href="#">Privacy Policy</a></li>
        <li><a href="#">Terms & Conditions</a></li>
        <li><a href="#">Cookie Policy</a></li>
        <li><a href="#">Accessibility Statement</a></li>
      </ul>
    </div>
  </div>

  <!-- الخط الفاصل -->
  <hr class="footer-line">

  <!-- الصف السفلي -->
  <div class="footer-bottom">
    <div class="language-box">
      <img src="{% static 'images/earth-globe0.png'%}" alt="earth" class="earth-icon">
      <span>Language</span>
    </div>
    <p>© 2025 Hembla Cleaning Services. All rights reserved.</p>
  </div>
</footer>
<!-- ===== JS تبعك كما هو ===== -->
 <script>
  const closeBtn = document.getElementById("closeBtn");
  const popup = document.getElementById("popup");

  if (closeBtn) {
    closeBtn.addEventListener("click", () => {
      popup.style.opacity = "0";
      popup.style.transform = "scale(0.9)";
      setTimeout(() => {
        popup.parentElement.style.display = "none";
      }, 300);
    });
  }
</script>

<script>
const passwordInput = document.querySelector('input[name="new_password1"]');
const strengthBar = document.getElementById("strengthBar");

if (passwordInput) {
  passwordInput.addEventListener("input", () => {
    const value = passwordInput.value;
    let strength = 0;

    if (/[a-z]/.test(value)) strength++;
    if (/[A-Z]/.test(value)) strength++;
    if (/[0-9]/.test(value)) strength++;
    if (/[^a-zA-Z0-9]/.test(value)) strength++;
    if (value.length >= 8) strength++;

    strengthBar.style.width = `${(strength / 5) * 100}%`;

    if (strength <= 2) strengthBar.style.background = "#e21010";
    else if (strength <= 4) strengthBar.style.background = "#ffe313";
    else strengthBar.style.background = "#64ff00";
  });
}

// show / hide password
document.querySelectorAll(".input-group .icon").forEach(icon => {
  icon.addEventListener("click", () => {
    const input = icon.previousElementSibling;
    input.type = input.type === "password" ? "text" : "password";
    icon.classList.toggle("fa-eye");
    icon.classList.toggle("fa-eye-slash");
  });
});
</script>
{% if show_popup %}
  <div class="popup-overlay">
    <div class="frame-1686552582" id="popup">
      <img class="close-window" src="{% static 'images/close-window0.png' %}" alt="Close" id="closeBtn">
      <img class="check-mark" src="{% static 'images/check-mark0.png' %}" alt="Success">
      <div class="your-password-has-been-updated-successfully">
        Your password has been updated successfully
      </div>
    </div>
  </div>
{% endif %}
<script>
document.addEventListener("DOMContentLoaded", function () {
  const closeBtn = document.getElementById("closeBtn");
  const popup = document.getElementById("popup");

  if (closeBtn && popup) {
    closeBtn.addEventListener("click", function () {
      popup.style.opacity = "0";
      popup.style.transform = "scale(0.9)";

      setTimeout(() => {
        popup.closest(".popup-overlay").style.display = "none";
      }, 300);
    });
  }
});
</script>


</body>
</html>
